{% extends "clatoolkit/base_clatoolkit.html" %}
{% load static %}

{% block title %}{{title}}{% endblock %}

{% block heading %}{{role}} Unit Management{% endblock %}

{% block body %}
<div class="row">
  <div class="col-lg-6">
        <div class="panel panel-info">
      {% if action %}
          {% if action == "new" and role == "Staff" %}
              <div class="panel-heading">
                 Create New Unit
              </div>
              <div class="panel-body">
                <form role="form" id="unit_form" method="post" action="/clatoolkit/unitmanagement/">
                    {% csrf_token %}
                    {{ unit_form.non_field_errors }}

                    <div class="form-group">
                        <p class="help-block">At least 1 social media account is required to run unit with CLAToolkit.</p>
                    </div>

                    <div class="form-group">
                        <p class="help-block">{{ unit_form.code.errors }}</p>
                        <label for="id_code">Unit Code:</label> (required) <br />
                        {{ unit_form.code }}
                    </div>

                    <div class="form-group">
                        <p class="help-block">{{ unit_form.name.errors }}</p>
                        <label for="id_name">Unit Name:</label> (required) <br />
                        {{ unit_form.name }}
                    </div>

                    <div class="form-group">
                        <p class="help-block">{{ unit_form.semester.errors }}</p>
                        <label for="id_semester">Semester:</label> <br />
                        {{ unit_form.semester }}
                    </div>

                    <div class="form-group">
                        <p class="help-block">{{ unit_form.description.errors }}</p>
                        <label for="id_desc">Description:</label> <br />
                        {{ unit_form.desc }}
                    </div>

                    <div class="form-group">
                        <p class="help-block">{{ unit_form.users.errors }}</p>
                        <label for="id_users">Users: </label> <br />
                        {{ unit_form.users }}
                    </div>

                    <div class="form-group">
                        <p class="help-block">{{ unit_form.coi_enabled.errors }}</p>
                        <label for="id_coi_enabled">Enable Community of Inquiry Classifier</label>
                        {{ unit_form.coi_enabled }}
                    </div>

                    <div class="form-group">
                        <p class="help-block">{{ unit_form.event_enabled.errors }}</p>
                        <label for="id_event_enabled">Event</label>
                        {{ unit_form.event_enabled }}
                    </div>

                    <div class="form-group">
                        <p class="help-block">{{ unit_form.unit_enabled.errors }}</p>
                        <label for="id_unit_enabled">Unit Available</label>
                        {{ unit_form.unit_enabled }}
                    </div>

                    <div class="form-group">
                        <h3>Social Media Configuration</h3>
                        <p class="help-block">{{ unit_form.twitter_hashtags.errors }}</p>
                        <label for="id_twitter_hashtags">Twitter Hashtags: </label> (hashtag begins with "#". multiple hashtags comma seperated.) <br />
                        {{ unit_form.twitter_hashtags }}
                    </div>

                    <div class="form-group">
                        <p class="help-block">{{ unit_form.google_groups.errors }}</p>
                        <label for="id_google_groups">Google+ Groups: </label> (multiple groups comma seperated.) <br />
                        {{ unit_form.google_groups }}
                    </div>

                    <div class="form-group">
                        <p class="help-block">{{ unit_form.facebook_groups.errors }}</p>
                        <label for="id_facebook_groups">Facebook Groups:</label> (multiple groups comma seperated.) <br />
                        {{ unit_form.facebook_groups }}
                    </div>

                    <div class="form-group">
                        <p class="help-block">{{ unit_form.forum_urls.errors }}</p>
                        <label for="id_forum_urls">Forum URLs:</label> (multiple urls comma seperated.) <br />
                        {{ unit_form.forum_urls }}
                    </div>

                    <div class="form-group">
                        <p class="help-block">{{ unit_form.youtube_channel_ids.errors }}</p>
                        <label for="id_youtube_channel_ids">YouTube Channel ID:</label> (multiple channel IDs comma seperated.) <br />
                        {{ unit_form.youtube_channel_ids }}
                    </div>

                    <div class="form-group">
                        <p class="help-block">{{ unit_form.blogmember_urls.errors }}</p>
                        <label for="id_blogmemeber_urls">Blog URLs: </label> (blogs must be RSS compatible, mutiple blog urls comma seperated.) <br />
                        {{ unit_form.blogmember_urls }}
                    </div>

                    <div class="form-group">
                        <h3>Learning Record Store (LRS) Configuration (optional)</h3>
                        <p class="help-block">{{  unit_form.lrs_endpoint.errors }}</p>
                        <label for="id_lrs_endpoint">LRS Endpoint: </label> <br />
                        {{ unit_form.lrs_endpoint }}
                    </div>

                    <div class="form-group">
                        <p class="help-block">{{ unit_form.lrs_username.errors }}</p>
                        <label for="id_lrs_username">LRS Username: </label> <br />
                        {{ unit_form.lrs_username }}
                    </div>

                    <div class="form-group">
                        <p class="help-block">{{ unit_form.lrs_password.errors }}</p>
                        <label for="id_lrs_password">LRS Password: </label> <br />
                        {{ unit_form.lrs_password }}
                    </div>
                    <button type="submit" class="btn btn-primary btn-lg btn-block">Create Unit Offering</button>
                </form>
              </div>

          {% endif %}

          {% if action == "edit" %}
              <div class="panel-heading">
                 Manage Unit: {{unit.code}}
              </div>

          {% endif %}

          {% if action == "unenrol" %}
              <p>You have successfully withdrawed from {{unit.code}}: {{unit.name}}. Your associated social media will no longer be captured.
              If you have any equiries, please don't hesitate to contact your course administrator.</p>
              <p><a href="/">Return Home</a></p>
          {% endif %}

      {% else %}

          <div class="panel-heading">
              Unit Offerings
          </div>
          <div class="panel-body">
            <table class="table table-hover">
                {% if units %}
                <thead>
                    <tr>
                        <th>Course Code</th>
                        <th>Name</th>
                        <th>Options</th>
                    </tr>
                </thead>
                {% endif %}
                <tbody>
                {% for unit in units %}
                    <tr>
                        <td>{{unit.code}}</td>
                        <td>{{unit.name}}</td>
                        <td>
                            <a href="/clatoolkit/unitmanagement/?action=unenrol&course_code={{unit.code}}"><i class="fa fa-sign-out fa-fw"></i> Withdraw</a>
                            {% if role == "Staff" %}
                                || <a href="/clatoolkit/unitmanagement/?action=edit&course_code={{unit.code}}">Edit</a> ||
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
          </div>
          {% if role == "Staff" %}
          <div class="panel-footer"><a href="/clatoolkit/unitmanagement/?action=new">Add new Unit</a></div>
          {% endif %}

  {% endif %}
        </div>
  </div>
  <!-- /.col-lg-6 -->

</div>
<!-- /.row -->
{% endblock %}

{% block js_block %}
{% autoescape off %}

{% endautoescape %}
{% endblock %}
